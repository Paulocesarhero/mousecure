<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../CSS/NavBarStyle.css">

    <title>Polizas</title>
    <style>
        table {
            margin: 0 auto;
            /* Centra la tabla horizontalmente */
            width: 80%;
            /* Ancho de la tabla */
            border-collapse: collapse;
            /* Combina las fronteras */
        }

        /* Estilos para las celdas de la tabla */
        th,
        td {
            border: 1px solid #ddd;
            /* Frontera alrededor de las celdas */
            padding: 8px;
            /* Espacio alrededor del texto en las celdas */
            text-align: center;
            /* Centra el texto horizontalmente */
        }

        /* Estilos para las celdas de encabezado */
        th {
            background-color: #4CAF50;
            /* Fondo verde */
            color: white;
            /* Texto blanco */
        }

        /* Estilos para las filas al pasar el mouse */
        tr:hover {
            background-color: #f5f5f5;
        }





        main {
            margin-top: 60px;
            /* Ajusta este valor según la altura de tu navbar */
        }
    </style>
</head>

<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <img src="../Resources/Icons/Mousecure - LT.png" height="32px" weight="32px" />MouSecure
            </div>

            <ul class="nav-links">
                <li class="dropdown">
                    <a tabindex="0">
                        <div class="imagen-contenedor">
                            <img id="imagenDinamica" src="../Resources/Icons/FlechaAbj - LT.png" alt="Imagen"
                                height="16px" weight="16px">
                        </div>
                        Reportes
                    </a>
                    <ul class="dropdown-content">
                        <li><a href="#"><img src="../Resources/Icons/ReportesUsuario - LT.png" height="32px"
                                    weight="32px" />Mis reportes</a></li>
                        <li><a href="../html/ReportarSiniestro.html"><img
                                    src="../Resources/Icons/ReportarSiniestro - LT.png" height="32px"
                                    weight="32px" />Reportar Siniestros</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a tabindex="0">
                        <div class="imagen-contenedor">
                            <img id="imagenDinamica" src="../Resources/Icons/FlechaAbj - LT.png" alt="Imagen"
                                height="16px" weight="16px">
                        </div>
                        Pólizas
                    </a>
                    <ul class="dropdown-content">
                        <li><a href="#"><img src="../Resources/Icons/PolizasUsuario - LT.png" height="32px"
                                    weight="32px" />Mis Pólizas</a></li>
                        <li><a href="#"><img src="../Resources/Icons/PolizasComprar - LT.png" height="32px"
                                    weight="32px" />Comprar Pólizas</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a tabindex="0">
                        <div class="imagen-contenedor">
                            <img id="imagenDinamica" src="../Resources/Icons/FlechaAbj - LT.png" alt="Imagen"
                                height="16px" weight="16px">
                        </div>
                        Contactos
                    </a>
                    <ul class="dropdown-content">
                        <li><a href="#"><img src="../Resources/Icons/ContactoCorreo - LT.png" height="32px"
                                    weight="32px" />Correo Electrónico</a></li>
                        <li><a href="#"><img src="../Resources/Icons/ContactoTelefono - LT.png" height="32px"
                                    weight="32px" />Número de celular</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a tabindex="0">
                        <img id="usuario_Option" src="../Resources/Icons/User - LT.png" height="35px" weight="35px" />
                    </a>
                    <ul class="dropdown-content">
                        <li><a href="#"><img src="../Resources/Icons/Ajustes - LT.png" height="32px"
                                    weight="32px" />Ajustes</a></li>
                        <li><a tabindex="0" id="logOut_NavBar"><img src="../Resources/Icons/LogOut - LT.png"
                                    height="32px" weight="32px" />Cerrar Sesión</a></li>
                    </ul>
                </li>
            </ul>

            <div class="menu-hamburguesa" tabindex="0">
                <img src="../Resources/Icons/HMenu - LT.png" height="35px" weight="35px" />
            </div>

            <div id="sidebar" class="sidebar">
                <ul class="sidebar-nav-links">
                    <li><a href="#" class="sidebar-header-User-Icon" tabindex="-1"><img id="usuario_Option_SideBar"
                                src="../Resources/Icons/User - LT.png" height="35px" weight="35px" />[Nombre de
                            Usuario]</a></li>
                    &nbsp;
                    <li class="sidebar-header">Reportes</li>
                    <hr>
                    <li class="sidebar-options"><a href="#" tabindex="-1"><img
                                src="../Resources/Icons/ReportesUsuario - LT.png" height="32px" weight="32px" />Mis
                            reportes</a></li>
                    <hr>
                    <li class="sidebar-options"><a href="#" tabindex="-1"><img
                                src="../Resources/Icons/ReportarSiniestro - LT.png" height="32px"
                                weight="32px" />Reportar Siniestros</a></li>
                    <hr>
                    &nbsp;
                    <li class="sidebar-header">Polizas</li>
                    <hr>
                    <li class="sidebar-options"><a href="#" tabindex="-1"><img
                                src="../Resources/Icons/PolizasUsuario - LT.png" height="32px" weight="32px" />Mis
                            Pólizas</a></li>
                    <hr>
                    <li class="sidebar-options"><a href="#" tabindex="-1"><img
                                src="../Resources/Icons/PolizasComprar - LT.png" height="32px" weight="32px" />Comprar
                            Pólizas</a></li>
                    <hr>
                    &nbsp;
                    <li class="sidebar-header">Contactos</li>
                    <hr>
                    <li class="sidebar-options"><a href="#" tabindex="-1"><img
                                src="../Resources/Icons/ContactoCorreo - LT.png" height="32px" weight="32px" />Correo
                            Electrónico</a></li>
                    <hr>
                    <li class="sidebar-options"><a href="#" tabindex="-1"><img
                                src="../Resources/Icons/ContactoTelefono - LT.png" height="32px" weight="32px" />Número
                            de celular</a></li>
                    <hr>
                    &nbsp;
                    <hr>
                    <li class="sidebar-options"><a id="logOut_SideBar" tabindex="-1"><img
                                src="../Resources/Icons/LogOut - LT.png" height="32px" weight="32px" />Cerrar Sesión</a>
                    </li>
                    <hr>
                </ul>
            </div>
        </nav>
    </header>
    <main>
        <table id="vehicles-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Modelo</th>
                    <th>Marca</th>
                    <th>Color</th>
                    <th>Placas</th>
                    <th>Tipo de Póliza</th>
                    <th>Fecha Inicio</th>
                    <th>Fecha Fin</th>
                </tr>
            </thead>
            <tbody>
                <!-- Las filas de la tabla se agregarán aquí -->
            </tbody>
        </table>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var idConductor = '1'; // Reemplaza esto con el ID del conductor

            fetch(`http://localhost:8000/vehiculos/${idConductor}`)
                .then(response => response.json())
                .then(vehiculos => {
                    var tableBody = document.querySelector('#vehicles-table tbody');
                    var vehicleIds = [];

                    vehiculos.forEach(vehiculo => {
                        var row = document.createElement('tr');

                        ['id', 'modelo', 'marca', 'color', 'placas'].forEach(key => {
                            var cell = document.createElement('td');
                            cell.textContent = vehiculo[key] || '';
                            row.appendChild(cell);
                        });

                        // Agrega celdas vacías para tipoPoliza, fechaInicio y fechaFin
                        ['tipoPoliza', 'fechaInicio', 'fechaFin'].forEach(() => {
                            var cell = document.createElement('td');
                            row.appendChild(cell);
                        });

                        tableBody.appendChild(row);

                        // Guarda el ID del vehículo para usarlo más tarde
                        vehicleIds.push(vehiculo.id);
                    });

                    // Llama al API para cada ID de vehículo
                    vehicleIds.forEach((id, index) => {
                        fetch(`http://localhost:8000/poliza/${id}`)
                            .then(response => response.json())
                            .then(poliza => {
                                var row = tableBody.children[index];

                                // Mapea el idPlan a un tipo de póliza
                                var tipoPoliza = '';
                                switch (poliza.idPlan) {
                                    case '1':
                                        tipoPoliza = 'Bronce';
                                        break;
                                    case '2':
                                        tipoPoliza = 'Plata';
                                        break;
                                    case '3':
                                        tipoPoliza = 'Oro';
                                        break;
                                }

                                // Llena las celdas vacías con los datos de la póliza
                                ['fehcaInicio', 'fechaFin'].forEach((key, i) => {
                                    row.children[5 + i].textContent = poliza[key] || '';
                                });

                                // Llena la celda de tipoPoliza con el tipo de póliza mapeado
                                row.children[5].textContent = tipoPoliza;
                            })
                            .catch(error => console.error('Error:', error));
                    });
                })
                .catch(error => console.error('Error:', error));
        });
    </script>
</body>

</html>